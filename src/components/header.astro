---
// src/components/header.astro

const categories = [
  {
    title: "Malé náradie",
    url: "/pozicovna-naradia/male-naradie",
    items: [
      { name: "Vŕtacie búracie kladivá a vŕtačky", url: "/pozicovna-naradia/male-naradie/vrtacie-buracie-kladiva-a-vrtacky" },
      { name: "Uhlové, vibračné a pásové brúsky", url: "/pozicovna-naradia/male-naradie/brusky" },
      { name: "Ručné píly a rezačky", url: "/pozicovna-naradia/male-naradie/pily-rezacky" },
      { name: "Vysávače, tepovače a tlakové čističe", url: "/pozicovna-naradia/male-naradie/vysavace-cistice" },
      { name: "Čerpadlá, ohrievače a odvlhčovače", url: "/pozicovna-naradia/male-naradie/cerpadla-ohriavace" },
      { name: "Zváracia a meracia technika", url: "/pozicovna-naradia/male-naradie/zvaracia-meracia" },
      { name: "Vibrátory, vibračné lišty a miešadla", url: "/pozicovna-naradia/male-naradie/vibratory-miesadla" },
      { name: "Lešenie", url: "/pozicovna-naradia/male-naradie/lesenie" },
      { name: "Záhradná technika", url: "/pozicovna-naradia/male-naradie/zahradna-technika" },
      { name: "Nádrže na vodu a naftu", url: "/pozicovna-naradia/male-naradie/nadrze" }
    ]
  },
  {
    title: "Stredná mechanizácia",
    url: "/pozicovna-naradia/stredna-mechanizacia",
    items: [
      { name: "Vibračné dosky a nohy", url: "/pozicovna-naradia/stredna-mechanizacia/vibracne-dosky" },
      { name: "Elektrocentrály", url: "/pozicovna-naradia/stredna-mechanizacia/elektrocentraly" },
      { name: "Kompresory", url: "/pozicovna-naradia/stredna-mechanizacia/kompresory" },
      { name: "Cestné rezačky, frézy a brúsky", url: "/pozicovna-naradia/stredna-mechanizacia/cestne-rezacky" },
      { name: "Stolové a portálové píly", url: "/pozicovna-naradia/stredna-mechanizacia/stolove-pily" },
      { name: "Miešačky, hladičky betónu a bádie", url: "/pozicovna-naradia/stredna-mechanizacia/miesacky-betonarske" }
    ]
  },
  {
    title: "Ťažká technika",
    url: "/pozicovna-naradia/tazka-technika",
    items: [
      { name: "Pásové mini-rýpadlá", url: "/pozicovna-naradia/tazka-technika/mini-rypadla" },
      { name: "Pásové ťažké rýpadlá", url: "/pozicovna-naradia/tazka-technika/tazke-rypadla" },
      { name: "Kolesové rýpadla a nakladače", url: "/pozicovna-naradia/tazka-technika/kolesove-rypadla" },
      { name: "Šmykom riadené nakladače", url: "/pozicovna-naradia/tazka-technika/smykom-riadene" },
      { name: "Dumpre", url: "/pozicovna-naradia/tazka-technika/dumpre" },
      { name: "Valce", url: "/pozicovna-naradia/tazka-technika/valce" }
    ]
  },
  {
    title: "Pracovné plošiny",
    url: "/pozicovna-naradia/pracovne-plosiny",
    items: [
      { name: "Interiérové plošiny", url: "/pozicovna-naradia/pracovne-plosiny/interierove-plosiny" },
      { name: "Exteriérové plošiny", url: "/pozicovna-naradia/pracovne-plosiny/exterierove-plosiny" }
    ]
  },
  {
    title: "Vybavenie staveniska",
    url: "/pozicovna-naradia/vybavenie-staveniska",
    items: [
      { name: "Kancelárske kontajnery a vrátnice", url: "/pozicovna-naradia/vybavenie-staveniska/kontajnery-vratnice" },
      { name: "Skladové kontajnery", url: "/pozicovna-naradia/vybavenie-staveniska/skladove-kontajnery" },
      { name: "Sanitárne kontajnery", url: "/pozicovna-naradia/vybavenie-staveniska/sanitarne-kontajnery" },
      { name: "Mobilné oplotenie a zábrany", url: "/pozicovna-naradia/vybavenie-staveniska/oplotenie-zabrany" },
      { name: "Mobilné toalety", url: "/pozicovna-naradia/vybavenie-staveniska/mobilne-toalety" }
    ]
  },
  {
    title: "Autá a prívesné vozíky",
    url: "/pozicovna-naradia/auta-privesy",
    items: [
      { name: "Autá a dodávky", url: "/pozicovna-naradia/auta-privesy/auta-dodavky" },
      { name: "Prívesné vozíky", url: "/pozicovna-naradia/auta-privesy/privesne-voziky" }
    ]
  }
];

const mainNav = [
  { name: "Domov", url: "/" },
  { name: "Požičovňa náradia", url: "/pozicovna-naradia", hasDropdown: true },
  { name: "Zemné a búracie práce", url: "/zemne-buracie-prace" },
  { name: "Kontakt", url: "/kontakt" }
];
---

<header class="fixed top-0 left-0 right-0 z-50 bg-gradient-to-b from-zinc-950/95 via-zinc-900/95 to-zinc-950/95 backdrop-blur-2xl border-b border-orange-500/10 shadow-2xl transition-all duration-500" id="header">
  
  <div class="absolute inset-0 overflow-hidden pointer-events-none opacity-20">
    <div class="absolute inset-0 bg-gradient-radial from-orange-500/10 via-transparent to-transparent"></div>
    <div class="absolute inset-0 bg-[radial-gradient(circle_at_1px_1px,rgba(255,107,0,0.15)_1px,transparent_0)] bg-[length:40px_40px]"></div>
  </div>

  <div class="max-w-[1600px] mx-auto px-4 md:px-8 relative z-10">
    <div class="header-wrap flex items-center justify-between h-20 transition-all duration-500">
      
      <!-- Logo - Bez rámu, väčšie -->
      <a href="/" class="flex items-center gap-3 group relative z-50">
        <div class="brand-logo relative transition-all duration-500">
          <div class="w-24 h-24 md:w-24 md:h-24 flex items-center justify-center transition-all duration-500 group-hover:scale-150 relative p-2">
            <img 
              src="/logo.png" 
              alt="ROYAL STROJE Logo" 
              class="w-full h-full object-contain relative z-10 drop-shadow-2xl filter brightness-110"
            />
          </div>
          <div class="absolute -inset-2 bg-gradient-to-br from-orange-500 to-orange-700 rounded-2xl blur-xl opacity-20 group-hover:opacity-40 transition-opacity duration-300 -z-10"></div>
        </div>
        
        <div class="brand-text hidden sm:block transition-all duration-500">
          <h1 class="text-xl md:text-2xl font-black text-white leading-none tracking-tight">
            ROYAL STROJE
          </h1>
          <span class="text-[9px] md:text-[10px] text-orange-500 uppercase tracking-[2px] md:tracking-[3px] font-bold">
            Požičovňa náradia
          </span>
        </div>
      </a>

      <!-- Desktop Navigation -->
      <nav class="hidden lg:flex items-center gap-2">
        {mainNav.map((item) => (
          <div class="relative nav-item group">
            <a 
              href={item.url} 
              class="nav-link flex items-center gap-2 px-6 py-3 text-gray-300 hover:text-white font-bold text-sm rounded-xl hover:bg-gradient-to-r hover:from-orange-500/10 hover:to-transparent transition-all duration-300 relative overflow-hidden"
            >
              <span class="absolute inset-0 bg-gradient-to-r from-orange-500/0 via-orange-500/20 to-orange-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-500"></span>
              <span class="relative z-10">{item.name}</span>
              {item.hasDropdown && (
                <svg class="w-4 h-4 transition-transform duration-300 group-hover:rotate-180 relative z-10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 9l-7 7-7-7"/>
                </svg>
              )}
            </a>

            {item.hasDropdown && (
              <div class="absolute top-full left-1/2 -translate-x-1/2 mt-3 w-[460px] bg-gradient-to-b from-zinc-900/98 to-zinc-950/98 backdrop-blur-2xl border border-orange-500/20 rounded-2xl shadow-2xl shadow-black/50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-500 max-h-[68vh] overflow-y-auto">
                <div class="p-4">
                  <div class="space-y-1.5 mb-4">
                    {categories.map((category) => (
                      <div class="accordion-item border border-white/5 rounded-xl overflow-hidden hover:border-orange-500/30 transition-all duration-300 bg-gradient-to-r from-zinc-800/30 to-zinc-900/20">
                        <button 
                          class="accordion-header w-full px-4 py-3 flex items-center justify-between text-left bg-gradient-to-r from-orange-500/5 to-transparent hover:from-orange-500/10 transition-all duration-300 group/btn"
                          type="button"
                        >
                          <span class="font-bold text-white text-xs group-hover/btn:text-orange-400 transition-colors">{category.title}</span>
                          <svg class="w-4 h-4 text-orange-500 transition-transform duration-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                            <path d="M19 9l-7 7-7-7"/>
                          </svg>
                        </button>
                        
                        <div class="accordion-content max-h-0 overflow-hidden transition-all duration-500">
                          <div class="p-4 bg-black/30 backdrop-blur-sm">
                            <a 
                              href={category.url} 
                              class="inline-flex items-center gap-2 px-3 py-2 mb-3 text-xs font-bold text-orange-500 bg-gradient-to-r from-orange-500/10 to-orange-600/5 hover:from-orange-500/20 hover:to-orange-600/10 border border-orange-500/30 hover:border-orange-500/50 rounded-lg transition-all duration-300 hover:translate-x-1"
                            >
                              <span>Všetko v kategórii</span>
                              <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                <path d="M5 12h14m-7-7l7 7-7 7"/>
                              </svg>
                            </a>
                            
                            <div class="space-y-1">
                              {category.items.map((subItem) => (
                                <a 
                                  href={subItem.url}
                                  class="flex items-center gap-2 px-3 py-2 text-xs text-gray-400 hover:text-white hover:bg-gradient-to-r hover:from-orange-500/10 hover:to-transparent rounded-lg transition-all duration-300 hover:translate-x-2 group/item"
                                >
                                  <div class="w-1.5 h-1.5 rounded-full bg-orange-500/40 group-hover/item:bg-orange-500 transition-all duration-300"></div>
                                  <span class="flex-1 font-medium leading-tight">{subItem.name}</span>
                                </a>
                              ))}
                            </div>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>

                  <div class="p-4 bg-gradient-to-br from-orange-500/15 via-orange-600/10 to-transparent border border-orange-500/30 rounded-xl text-center backdrop-blur-sm">
                    <h4 class="text-white font-black text-base mb-1.5">Potrebujete poradiť?</h4>
                    <p class="text-gray-400 text-xs mb-3 font-medium">Kontaktujte nás a pomôžeme vám vybrať správne náradie</p>
                    <a 
                      href="tel:+421948555551" 
                      class="inline-flex items-center gap-2.5 px-5 py-2.5 bg-gradient-to-r from-orange-500 via-orange-600 to-orange-500 bg-[length:200%_100%] hover:bg-right text-black font-black text-sm rounded-full shadow-lg shadow-orange-500/30 hover:shadow-orange-500/60 hover:scale-105 transition-all duration-500"
                    >
                      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.01-.24c1.11.37 2.31.57 3.58.57a1 1 0 011 1v3.5a1 1 0 01-1 1C12.4 21.82 2.18 11.6 2.18 3a1 1 0 011-1H6.7a1 1 0 011 1c0 1.27.2 2.47.57 3.58a1 1 0 01-.24 1.01l-2.2 2.2z"/>
                      </svg>
                      <span>0948 555 551</span>
                    </a>
                  </div>
                </div>
              </div>
            )}
          </div>
        ))}
      </nav>

      <!-- Header Actions -->
      <div class="header-actions hidden lg:flex items-center gap-4 transition-all duration-500">
        
        <!-- Online Status -->
        <div class="online-status flex items-center gap-2.5 px-4 py-2.5 bg-gradient-to-r from-orange-500/10 to-orange-600/5 border border-orange-500/30 rounded-full backdrop-blur-sm transition-all duration-500">
          <div class="relative">
            <div class="w-2.5 h-2.5 bg-orange-500 rounded-full animate-pulse"></div>
            <div class="absolute inset-0 w-2.5 h-2.5 bg-orange-500 rounded-full animate-ping"></div>
          </div>
          <span class="text-orange-500 text-xs font-black uppercase tracking-wider">ONLINE 24/7</span>
        </div>

        <!-- Phone CTA -->
        <a 
          href="tel:+421948555551" 
          class="phone-cta flex items-center gap-2.5 px-6 py-3 bg-gradient-to-r from-orange-500 via-orange-600 to-orange-500 bg-[length:200%_100%] hover:bg-right text-black font-black rounded-full shadow-lg shadow-orange-500/30 hover:shadow-orange-500/60 hover:scale-105 transition-all duration-500"
        >
          <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
            <path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.01-.24c1.11.37 2.31.57 3.58.57a1 1 0 011 1v3.5a1 1 0 01-1 1C12.4 21.82 2.18 11.6 2.18 3a1 1 0 011-1H6.7a1 1 0 011 1c0 1.27.2 2.47.57 3.58a1 1 0 01-.24 1.01l-2.2 2.2z"/>
          </svg>
          <span class="phone-number text-base transition-all duration-500">0948 555 551</span>
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button 
        class="lg:hidden flex flex-col gap-1.5 w-10 h-10 items-center justify-center rounded-xl hover:bg-orange-500/10 transition-all duration-300 group z-50" 
        id="mobileMenuBtn"
        aria-label="Otvoriť menu"
      >
        <span class="w-6 h-0.5 bg-white group-hover:bg-orange-500 transition-all duration-300 origin-center mobile-line-1"></span>
        <span class="w-6 h-0.5 bg-white group-hover:bg-orange-500 transition-all duration-300 mobile-line-2"></span>
        <span class="w-6 h-0.5 bg-white group-hover:bg-orange-500 transition-all duration-300 origin-center mobile-line-3"></span>
      </button>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div 
    class="lg:hidden fixed inset-0 top-20 bg-gradient-to-b from-zinc-950/98 via-zinc-900/98 to-black/98 backdrop-blur-2xl -translate-y-full opacity-0 transition-all duration-500 overflow-y-auto z-40" 
    id="mobileMenu"
  >
    <div class="p-6 space-y-3 pb-32">
      {mainNav.map((item) => (
        <a 
          href={item.url}
          class="block px-6 py-4 text-white font-bold text-lg border border-orange-500/30 hover:border-orange-500 rounded-2xl hover:bg-gradient-to-r hover:from-orange-500/20 hover:to-transparent transition-all duration-300"
        >
          {item.name}
        </a>
      ))}
      
      <div class="pt-6">
        <a 
          href="tel:+421948555551" 
          class="flex items-center justify-center gap-3 px-8 py-5 bg-gradient-to-r from-orange-500 via-orange-600 to-orange-500 bg-[length:200%_100%] text-black font-black text-xl rounded-2xl shadow-2xl shadow-orange-500/30"
        >
          <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
            <path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.01-.24c1.11.37 2.31.57 3.58.57a1 1 0 011 1v3.5a1 1 0 01-1 1C12.4 21.82 2.18 11.6 2.18 3a1 1 0 011-1H6.7a1 1 0 011 1c0 1.27.2 2.47.57 3.58a1 1 0 01-.24 1.01l-2.2 2.2z"/>
          </svg>
          0948 555 551
        </a>
      </div>
    </div>
  </div>
</header>

<script>
  // PERFEKTNÝ SCROLL EFEKT
  const header = document.getElementById('header');
  const headerWrap = header?.querySelector('.header-wrap');
  const brandLogo = header?.querySelector('.brand-logo');
  const brandText = header?.querySelector('.brand-text');
  const navLinks = header?.querySelectorAll('.nav-link');
  const headerActions = header?.querySelector('.header-actions');
  const onlineStatus = header?.querySelector('.online-status');
  const phoneCta = header?.querySelector('.phone-cta');
  const phoneNumber = header?.querySelector('.phone-number');
  
  window.addEventListener('scroll', () => {
    const scrolled = window.scrollY;
    
    if (scrolled > 50) {
      // Zmenší header
      headerWrap?.style.setProperty('height', '64px');
      
      // ZVÄČŠÍ logo
      brandLogo?.style.setProperty('transform', 'scale(1.15)');
      
      // Zmenší text
      brandText?.style.setProperty('transform', 'scale(0.85)');
      brandText?.style.setProperty('opacity', '0.9');
      
      // Zmenší navigáciu
      navLinks?.forEach(link => {
        link.style.setProperty('padding', '8px 16px');
        link.style.setProperty('font-size', '13px');
      });
      
      // Zmenší actions
      headerActions?.style.setProperty('transform', 'scale(0.9)');
      
      // ZVÝRAZNÍ online status
      onlineStatus?.style.setProperty('background', 'linear-gradient(to right, rgba(255,107,0,0.2), rgba(255,139,58,0.1))');
      onlineStatus?.style.setProperty('border-color', 'rgba(255,107,0,0.5)');
      onlineStatus?.style.setProperty('box-shadow', '0 0 20px rgba(255,107,0,0.3)');
      
      // ZVÝRAZNÍ telefón
      phoneCta?.style.setProperty('box-shadow', '0 8px 30px rgba(255,107,0,0.5)');
      phoneNumber?.style.setProperty('font-size', '15px');
      
      // Shadow
      header?.classList.add('!shadow-[0_10px_40px_rgba(255,107,0,0.15)]');
      
    } else {
      // Vráti normálnu veľkosť
      headerWrap?.style.setProperty('height', '80px');
      brandLogo?.style.setProperty('transform', 'scale(1)');
      brandText?.style.setProperty('transform', 'scale(1)');
      brandText?.style.setProperty('opacity', '1');
      
      navLinks?.forEach(link => {
        link.style.setProperty('padding', '12px 24px');
        link.style.setProperty('font-size', '15px');
      });
      
      headerActions?.style.setProperty('transform', 'scale(1)');
      onlineStatus?.style.removeProperty('background');
      onlineStatus?.style.removeProperty('border-color');
      onlineStatus?.style.removeProperty('box-shadow');
      phoneCta?.style.removeProperty('box-shadow');
      phoneNumber?.style.setProperty('font-size', '16px');
      header?.classList.remove('!shadow-[0_10px_40px_rgba(255,107,0,0.15)]');
    }
  }, { passive: true });

  // Accordion
  const accordionHeaders = document.querySelectorAll('.accordion-header');
  accordionHeaders.forEach(header => {
    header.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      const item = header.closest('.accordion-item');
      const content = item?.querySelector('.accordion-content');
      const icon = header.querySelector('svg');
      const isOpen = content?.style.maxHeight && content.style.maxHeight !== '0px';
      
      document.querySelectorAll('.accordion-content').forEach(c => { c.style.maxHeight = '0'; });
      document.querySelectorAll('.accordion-header svg').forEach(i => { i.style.transform = 'rotate(0deg)'; });
      
      if (!isOpen && content) {
        content.style.maxHeight = content.scrollHeight + 'px';
        if (icon) icon.style.transform = 'rotate(180deg)';
      }
    });
  });

  // Mobile menu
  const mobileBtn = document.getElementById('mobileMenuBtn');
  const mobileMenu = document.getElementById('mobileMenu');
  const line1 = mobileBtn?.querySelector('.mobile-line-1');
  const line2 = mobileBtn?.querySelector('.mobile-line-2');
  const line3 = mobileBtn?.querySelector('.mobile-line-3');
  
  mobileBtn?.addEventListener('click', () => {
    const isOpen = !mobileMenu?.classList.contains('-translate-y-full');
    
    if (isOpen) {
      mobileMenu?.classList.add('-translate-y-full', 'opacity-0');
      document.body.style.overflow = '';
      line1?.classList.remove('rotate-45', 'translate-y-2');
      line2?.classList.remove('opacity-0');
      line3?.classList.remove('-rotate-45', '-translate-y-2');
    } else {
      mobileMenu?.classList.remove('-translate-y-full', 'opacity-0');
      document.body.style.overflow = 'hidden';
      line1?.classList.add('rotate-45', 'translate-y-2');
      line2?.classList.add('opacity-0');
      line3?.classList.add('-rotate-45', '-translate-y-2');
    }
  });

  mobileMenu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      mobileMenu?.classList.add('-translate-y-full', 'opacity-0');
      document.body.style.overflow = '';
      line1?.classList.remove('rotate-45', 'translate-y-2');
      line2?.classList.remove('opacity-0');
      line3?.classList.remove('-rotate-45', '-translate-y-2');
    });
  });
</script>